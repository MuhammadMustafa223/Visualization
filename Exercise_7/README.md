# Problem Sheet 7 — Exploratory Analysis and Schema Visualization

Purpose and objectives

This problem sheet is designed to deepen practical skills in exploratory data analysis, conditional distribution inspection, and schema visualization. The primary aim is to teach how to extract meaningful patterns from tabular demographic data and how to present relational database designs clearly using graph-based visual metaphors. Working through these exercises you will learn to: preprocess and inspect real-world CSV data, choose appropriate visual encodings (histograms, scatter plots, log scaling, KDE overlays) to reveal distributional structure and heterogeneity, and interpret how population size affects demographic ratios such as the fraction of women or fraction of foreign residents. In parallel, the sheet trains you to translate a relational schema into a decorated directed graph that communicates table entities, non-key attributes, relationships, and cardinalities — a skill useful for database design reviews, documentation, and as input for automated schema tooling. The objective paragraph emphasizes not just which tools to use, but why: choosing log scales to compensate for heavy-tailed population counts, plotting conditional distributions to reveal size-dependent biases, and drawing labeled edges to explicitly show relationship semantics and multiplicities. By the end of the sheet you should be comfortable turning raw CSVs and design ideas into compact visual summaries that support data-driven decisions and technical communication.

Concise per-question explanations

Exercise 7.1 — Conditional distributions in census data

- What the notebook does:
  - Loads `census.csv` using pandas (`sep=';'`).
  - Prints or displays the dataframe to inspect column names and types.
  - Plots the marginal distribution of the municipality population column `Total` with `seaborn.histplot` (KDE enabled). The x-axis is often log-scaled to make distributions across many orders of magnitude more interpretable.
  - Plots scatter visualizations of `rel_women` vs `Total` and `rel_foreign` vs `Total` (again using a log scale on the x-axis). These scatter plots show how demographic fractions vary with municipality size and help spot trends, heteroscedasticity, or population-size dependent artifacts.
- Why it matters (short): These plots reveal how conditional distributions (e.g., fraction of women given municipality size) change across scales and identify whether demographic measures are stable across small and large municipalities or whether they systematically vary with population.

- Key implementation notes:
  - `sns.histplot(df['Total'], bins=50, kde=True)` for an interpretable density estimate.
  - Use `plt.xscale('log')` to handle heavy tails and make patterns in small vs large municipalities visible.
  - Use `sns.scatterplot` for conditional scatter views and `plt.tight_layout()` to avoid overlapping axes labels.

Exercise 7.2 — Visualizing a relational database as a decorated graph

- What the notebook does:
  - Presents a suggested set of non-key columns for common tables (Journalist, Article, Category, Reader, Comment, Reaction).
  - Builds a directed NetworkX graph (`nx.DiGraph`) where each table is a node.
  - Adds edges that encode relationships and short labels describing relation names and cardinalities (for example, `authored_by (1:1)`, `assigned_to (many-to-many)`).
  - Uses `nx.spring_layout` for node positioning, draws nodes, labels and edge labels, and saves the figure as `exercise7_2_decorated_graph.png`.
- Why it matters (short): The decorated graph is an immediate visual summary of schema topology and semantics. Labeled edges make the intended referential structure and multiplicities explicit, improving design reviews and communication between data engineers and stakeholders.

- Key implementation notes:
  - Use `nx.draw_networkx_nodes`, `nx.draw_networkx_labels`, and `nx.draw_networkx_edge_labels` to create a readable, publication-ready schema diagram.
  - Save the visualization with `plt.savefig(...)` so it can be embedded in documentation or reports.

Files required / generated

- Required for Exercise 7.1: `census.csv` (must be in the same folder or path updated in the notebook). The notebook loads it via `pd.read_csv('census.csv', sep=';')`.
- Generated by Exercise 7.2: `exercise7_2_decorated_graph.png` (diagram of the schema saved by the notebook).

Dependencies

- The notebook uses standard scientific Python libraries. Typical minimal environment (install with pip):

```powershell
pip install numpy pandas seaborn matplotlib networkx
```

Tips & notes

- If `Total` spans many orders of magnitude, the log scale on the x-axis is essential; otherwise small municipalities are invisible in linear-space histograms.
- When inspecting `rel_women` or `rel_foreign`, color or size encoding can be added (for example color by canton or region if available) to highlight geographic patterns.
- The decorated graph is a conceptual diagram: for production documentation you may want to add primary/foreign key names and constraints, or export to a vector format (SVG/PDF) for better print quality.

How to run

- Open `07-Exercise.ipynb` in JupyterLab / Jupyter Notebook and run the cells top-to-bottom.
- Ensure `census.csv` is present in the same directory as the notebook. After running the schema cell, `exercise7_2_decorated_graph.png` will be created in the working directory.

